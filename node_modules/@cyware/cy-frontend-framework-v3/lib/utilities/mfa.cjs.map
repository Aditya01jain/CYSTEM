{"version":3,"file":"mfa.cjs","sources":["../../src/utilities/mfa.js"],"sourcesContent":["const getCookie = (cn) =>\n  decodeURIComponent(document.cookie)\n    .split(';')\n    .find(c => c.trim().startsWith(`${cn}=`))\n    ?.split('=')[1] || '';\n\nexport const makeMfaRemotes = (mfaList = '', url = '') => {\n  const list = mfaList ? JSON.parse(mfaList) : [];\n  const remotes = {};\n  for (const i of list) {\n    remotes[`mfa-${i}`] = {\n      external: `new Promise(resolve => {const Cookies = ${getCookie}; resolve(\\`${url}/mfa/${i}/assets/mfa.js?v=\\${Cookies(\"mfa_version\")}\\`);}).then(url => url)`,\n      externalType: 'promise'\n    };\n  }\n  return remotes;\n};\n\nlet version = '';\nexport async function setMfaVersion(p, pv, url = '') {\n  try {\n    if (!version && pv) {\n      await callMFAService(p, pv, url);\n      version = getCookie('mfa_version');\n      document.addEventListener('visibilitychange', function () {\n        if (document.hidden) {\n          callMFAService(p, pv, url);\n        }\n      });\n      return true;\n    }\n  } catch (e) {\n    return true;\n  }\n}\nasync function callMFAService(p, pv, url) {\n  await fetch(`${url || ''}/mfa/version/${p}/${pv}/`, {\n    credentials: 'include'\n  });\n}\n"],"names":["getCookie","cn","c","makeMfaRemotes","mfaList","url","list","remotes","i","version","setMfaVersion","p","pv","callMFAService"],"mappings":"gFAAA,MAAMA,EAAaC,GACjB,mBAAmB,SAAS,MAAM,EAC/B,MAAM,GAAG,EACT,KAAKC,GAAKA,EAAE,KAAM,EAAC,WAAW,GAAGD,CAAE,GAAG,CAAC,GACtC,MAAM,GAAG,EAAE,CAAC,GAAK,GAEVE,EAAiB,CAACC,EAAU,GAAIC,EAAM,KAAO,CACxD,MAAMC,EAAOF,EAAU,KAAK,MAAMA,CAAO,EAAI,GACvCG,EAAU,CAAA,EAChB,UAAWC,KAAKF,EACdC,EAAQ,OAAOC,CAAC,EAAE,EAAI,CACpB,SAAU,2CAA2CR,CAAS,eAAeK,CAAG,QAAQG,CAAC,qEACzF,aAAc,SACpB,EAEE,OAAOD,CACT,EAEA,IAAIE,EAAU,GACP,eAAeC,EAAcC,EAAGC,EAAIP,EAAM,GAAI,CACnD,GAAI,CACF,GAAI,CAACI,GAAWG,EACd,aAAMC,EAAeF,EAAGC,EAAIP,CAAG,EAC/BI,EAAUT,EAAU,aAAa,EACjC,SAAS,iBAAiB,mBAAoB,UAAY,CACpD,SAAS,QACXa,EAAeF,EAAGC,EAAIP,CAAG,CAEnC,CAAO,EACM,EAEV,MAAW,CACV,MAAO,EACR,CACH,CACA,eAAeQ,EAAeF,EAAGC,EAAIP,EAAK,CACxC,MAAM,MAAM,GAAGA,GAAO,EAAE,gBAAgBM,CAAC,IAAIC,CAAE,IAAK,CAClD,YAAa,SACjB,CAAG,CACH"}