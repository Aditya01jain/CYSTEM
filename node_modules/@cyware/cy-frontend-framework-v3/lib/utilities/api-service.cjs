"use strict";Object.defineProperties(exports,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}});const S=require("axios"),U=require("js-cookie"),g="application/json",a=(s,i,r,o)=>{const u={status:!0,data:i.data,code:i.status,component:s,instance:o};return r&&r(u),u},d=(s,i,r,o)=>{const u={status:!1,error:i?.response?.data,code:i?.response?.status||502,component:s,instance:o,isCancelled:S.isCancel(i)};return r&&r(u),Promise.reject(u)},C=s=>{const i=s.tokenKey?U.get(s.tokenKey):s.token;return{baseURL:s.baseUrl+s.slug,token:i}},L=()=>S.create({paramsSerializer:s=>new URLSearchParams(s).toString(),allowAbsoluteUrls:!0,headers:{Accept:g,"Content-Type":g}}),P=(s,i)=>{const r=L();let o=s.apiServices;const u=(e,n,t)=>{const{service:c,componentSlug:f}=l(e,t);if(s.config?.[c]){let h=s.config[c]?.[f]?.api||f;return n&&(h+=`${n}/`),h}else return f},l=(e,n)=>{const t=e?.split(".");return t.length>1?(v(o[n||t[0]]),{service:t[0],componentSlug:t[1]}):{componentSlug:e,service:""}},v=e=>{const{baseURL:n,token:t}=C(e);r.defaults.baseURL=n,r.defaults.headers.Authorization=`${e.tokenPrefix||s.tokenPrefix} ${t}`};return{get:function(e,n){return r.get(u(e,n?.id,n?.instance),n).then(t=>a(e,t,i,this)).catch(t=>d(e,t,i,this))},post:function(e,n,t){return r.post(u(e,t?.id,t?.instance),n,t).then(c=>a(e,c,i,this)).catch(c=>d(e,c,i,this))},put:function(e,n,t){return r.put(u(e,t?.id,t?.instance),n).then(c=>a(e,c,i,this)).catch(c=>d(e,c,i,this))},delete:function(e,n){return r.delete(u(e,n?.id,n?.instance),n).then(t=>a(e,t,i,this)).catch(t=>d(e,t,i,this))},appendServices:function(e){o={...o,...e}},updateService:function(e,n){const t={...o[e],...n};this.appendServices({[e]:t})},services:()=>o,appendConfig:function(e){s.config={...s.config,...e}},appendCallback:e=>{i=e}}};exports.default=P;
//# sourceMappingURL=api-service.cjs.map
