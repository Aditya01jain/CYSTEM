{"version":3,"file":"aria-utils.cjs","sources":["../../src/utilities/aria-utils.js"],"sourcesContent":["import { isNull } from \"./shared\";\n\nvar aria = aria || {};\n\nconst TAB_SELECTOR =\n  'button:not([tabindex=\"-1\"]), [href], input:not([tabindex=\"-1\"]), textarea:not([tabindex=\"-1\"]), [tabindex=\"0\"]';\n\nconst getAttribute = (element, key, equateValue = \"true\") => {\n  return element?.getAttribute(key, false) === equateValue;\n};\n\nconst focusableElements = (element) => {\n  return Array.from(element.querySelectorAll(TAB_SELECTOR)).filter((node) =>\n    aria.Utils.isElementVisible(node)\n  );\n};\n\nfunction hasWidthHeight(node) {\n  return (\n    node?.clientHeight > 0 &&\n    node?.clientWidth > 0 &&\n    !node?.classList?.contains(\"is-hidden\")\n  );\n}\n\nconst focusFirstDescendant = (element) => {\n  for (let node of element?.childNodes || []) {\n    if (\n      aria.Utils.attemptFocus(node) ||\n      aria.Utils.focusFirstDescendant(node)\n    ) {\n      return true;\n    }\n  }\n  return false;\n};\n\nconst attemptFocus = (element) => {\n  if (!aria.Utils.isFocusable(element)) return false;\n  aria.Utils.IgnoreUtilFocusChanges = true;\n  try {\n    element.focus();\n  } catch (e) {}\n  aria.Utils.IgnoreUtilFocusChanges = false;\n\n  return document.activeElement === element;\n};\n\nconst isFocusable = (element) => {\n  if (\n    element?.tabIndex > 0 ||\n    (element?.tabIndex === 0 && element.getAttribute(\"tabIndex\") !== null)\n  )\n    return true;\n\n  if (element?.disabled) {\n    return false;\n  }\n\n  switch (element?.nodeName) {\n    case \"A\":\n      return !!element.href && element.rel !== \"ignore\";\n    case \"INPUT\":\n      return element.type !== \"hidden\" && element.type !== \"file\";\n    case \"BUTTON\":\n    case \"SELECT\":\n    case \"TEXTAREA\":\n      return true;\n    default:\n      return false;\n  }\n};\n\nconst isElementVisible = (element) => {\n  return (\n    element?.offsetWidth ||\n    element?.offsetHeight ||\n    element?.getClientRects()?.length\n  );\n};\n\nconst preventEvents = (event) => {\n  event?.preventDefault();\n  event?.stopPropagation();\n};\n\nconst findNextFocusable = (node, type = \"next\") => {\n  let nodes = focusableElements(node);\n  let nodeIndex = 0;\n  for (let node of nodes) {\n    if (node === document?.activeElement) break;\n    nodeIndex++;\n  }\n  if (type === \"prev\") {\n    return nodeIndex <= 0 ? null : nodes[nodeIndex - 1];\n  }\n  return nodeIndex < nodes?.length ? nodes[nodeIndex + 1] : null;\n};\n\nconst findNode = (node, parentNode = document) => {\n  if (typeof node === \"string\") {\n    return parentNode?.querySelector(node);\n  }\n  return node || null;\n};\n\nconst focusLastDescendant = (element) => {\n  let nodes = [...(element.childNodes || [])].reverse();\n  for (let node of nodes) {\n    if (aria.Utils.attemptFocus(node) || aria.Utils.focusLastDescendant(node))\n      return true;\n  }\n  return false;\n};\n\nconst isElementTabbable = (element) => {\n  const tabIndex = element?.getAttribute(\"tabIndex\");\n  if (tabIndex < 0 && !isNull(element)) return false;\n  if (\n    getAttribute(element, \"aria-disabled\") ||\n    getAttribute(element, \"disabled\") ||\n    getAttribute(element, \"aria-hidden\") ||\n    getAttribute(element, \"data-skip-focus\")\n  )\n    return false;\n  return true;\n};\n\nconst findEndNodes = (element) => {\n  let focusable = Array.from(element.querySelectorAll(TAB_SELECTOR)).filter(\n    (node) => aria.Utils.isElementVisible(node)\n  );\n  let start = 0,\n    end = 0;\n  if (focusable?.length > 1) end = focusable?.length - 1;\n  if (start === end) return { first: focusable?.[0], last: null };\n  return { first: focusable?.[0], last: focusable?.[end] };\n};\n\naria.Utils = {\n  ...(aria?.Utils || {}),\n  focusFirstDescendant,\n  attemptFocus,\n  isFocusable,\n  preventEvents,\n  isElementVisible,\n  findEndNodes,\n  findNextFocusable,\n  focusLastDescendant,\n  findNode,\n  isElementTabbable\n};\n\nexport {\n  focusableElements,\n  findNextFocusable,\n  isElementTabbable,\n  findEndNodes,\n  findNode,\n  preventEvents,\n  getAttribute,\n  hasWidthHeight,\n  attemptFocus,\n  focusFirstDescendant,\n  focusLastDescendant,\n  isElementVisible,\n  isFocusable,\n  TAB_SELECTOR\n};\n\nexport default aria.Utils;\n"],"names":["aria","TAB_SELECTOR","getAttribute","element","key","equateValue","focusableElements","node","hasWidthHeight","focusFirstDescendant","attemptFocus","isFocusable","isElementVisible","preventEvents","event","findNextFocusable","type","nodes","nodeIndex","findNode","parentNode","focusLastDescendant","isElementTabbable","isNull","findEndNodes","focusable","start","end","ariaUtils"],"mappings":"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"}