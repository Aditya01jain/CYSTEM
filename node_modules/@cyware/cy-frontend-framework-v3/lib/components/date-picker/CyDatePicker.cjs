"use strict";Object.defineProperties(exports,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}});const t=require("vue"),B=require("../../hoc-components/CyDatePickerHoc.cjs"),P=require("../../CyWrapperLabel.vue_vue_type_script_setup_true_lang-d359d188.cjs"),$=require("../../mixins/helpTextMixin.cjs"),q=require("../../mixins/defaultProps.cjs"),I=require("element-plus"),O=require("element-plus/es/locale/lang/en"),m=require("../../utilities/time.cjs"),H=require("../../utilities/shared.cjs"),E=require("../../CyHelpText.vue_vue_type_script_setup_true_lang-ddbd16f8.cjs"),M=require("../../_plugin-vue_export-helper-f246444f.cjs"),g=["datetimerange","daterange"],j=t.defineComponent({name:"CyDatePicker",components:{CyHelpText:E._sfc_main,CyDatePickerHoc:B.default,CyWrapperLabel:P._sfc_main},mixins:[$.default,q.default],props:{modelValue:{type:[String,Number,Date,Array,null],default:null},options:{type:Object,default:()=>({})},disabled:{type:Boolean,default:!1},floatLabel:{type:Boolean,default:!0},label:{type:String,default:null},prefixIcon:{type:String,default:""},wrapperStyle:{type:Object,default:()=>({})},wrapperClass:{type:String,default:""},labelClass:{type:String,default:""},timezone:{type:String,default:null},startDate:{type:[Date,Number,String],default:null},endDate:{type:[Date,Number,String],default:null},defaultTime:{type:[Date,Array],default:null}},setup(e,{emit:l,expose:D}){const s=t.ref(null),c=t.ref(!1),f=t.ref(!1),r=t.ref(!1),i=t.ref(null),y=`cyw-datepicker-${H.uuId()}`,u=Intl.DateTimeFormat().resolvedOptions().timeZone,o=t.ref(e.timezone||u),C=()=>e.defaultTime||(g.includes(e.options?.type)?[new Date(2e3,1,1,0,0,0),new Date(2e3,1,1,23,59,59)]:new Date(2e3,1,1,0,0,0)),b=()=>{if(r.value)return r.value=!1,e.modelValue;if(g.includes(e.options?.type)){i.value=(e.modelValue||[]).map(a=>m.fromTzToLocal(a,o.value));return}i.value=m.fromTzToLocal(e.modelValue,o.value)},T=a=>{let n;o.value?n=new Date().toLocaleDateString("en",{timeZone:o.value}):n=new Date().toLocaleDateString("en");const p=new Date(a).toLocaleDateString("en");let v="";return w(a)&&(v="normal disabled"),(n===p?"cy-today ":"")+v},h=a=>{if(r.value=!0,g.includes(e.options?.type)){l("update:modelValue",(a||[]).map(n=>m.fromLocalToTz(n,o.value,e.options?.valueFormat)));return}l("update:modelValue",m.fromLocalToTz(a,o.value,e.options?.valueFormat))},w=a=>e.startDate&&d(a)<d(e.startDate,!0)||e.endDate&&d(a)>d(e.endDate,!0),d=(a,n)=>{let p;return n?p=new Date(a).toLocaleDateString("en",{timeZone:o.value}):p=new Date(a).toLocaleDateString("en"),new Date(p)},k=a=>{f.value=!0,l("focus",a)},S=a=>{l("change",a)},V=a=>{l("visibleChange",a)},N=a=>{f.value=!1,setTimeout(()=>c.value=!1,100),l("blur",a)},L=a=>{c.value=a,l("inputFocus",a)},z=()=>{s.value&&s.value.handleOpen()},F=()=>{s.value&&s.value.handleClose()};return t.watch(()=>e.modelValue,()=>{b()}),t.onMounted(()=>{const{locale:a}=I.useLocale();a.value=O,b()}),D({handleOpen:z,handleClose:F}),{isFocused:c,isTransformed:f,isPicked:r,dateModel:i,inputId:y,getDate:b,getDefaultTime:C,isTodayOrDisabled:T,setDate:h,disabledDate:w,getTime:d,focus:k,change:S,blur:N,handleInputFocus:L,datePickerHocRef:s,visibleChange:V}}}),Z={class:"cyw-text-medium"},A={key:0,class:"cyw-ml-2"};function R(e,l,D,s,c,f){const r=t.resolveComponent("CyHelpText"),i=t.resolveComponent("cy-wrapper-label"),y=t.resolveComponent("cy-date-picker-hoc");return t.openBlock(),t.createElementBlock(t.Fragment,null,[!e.floatLabel&&e.label?(t.openBlock(),t.createElementBlock("div",{key:0,class:t.normalizeClass(["cyw-label cyw-flex cyw-text-f12 cyw-color-N700",[e.labelClass+" ",{"--disabled":e.disabled}]])},[t.renderSlot(e.$slots,"label",{},()=>[t.createElementVNode("label",Z,t.toDisplayString(e.label),1),e.helpText?(t.openBlock(),t.createElementBlock("span",A,[t.createVNode(r,{helpText:e.helpText,id:`${e.name}-helptext`},null,8,["helpText","id"])])):t.createCommentVNode("v-if",!0)])],2)):t.createCommentVNode("v-if",!0),t.createElementVNode("div",{class:t.normalizeClass(["cyw-input cyw-wrapper cyw-w-100 cyw-datepicker",[[e.wrapperClass,`cyw-input --${e.inputSize}`,`cyw-wrapper--${e.inputSize}`,`cyw-datepicker--${e.inputSize}`].join(" "),{focused:e.isFocused||e.isTransformed,selected:e.dateModel,disabled:e.disabled}]]),style:t.normalizeStyle(e.wrapperStyle)},[e.floatLabel?(t.openBlock(),t.createBlock(i,{key:0,label:e.label,transform:e.modelValue||e.isTransformed,"is-focused":e.isFocused||e.isTransformed||!!e.modelValue,for:e.inputId},null,8,["label","transform","is-focused","for"])):t.createCommentVNode("v-if",!0),t.createVNode(y,t.mergeProps({ref:"datePickerHocRef",modelValue:e.dateModel,"onUpdate:modelValue":l[0]||(l[0]=u=>e.dateModel=u),class:"cyw-w-100 cyw-p-0",disabled:e.disabled,"input-id":e.inputId,"prefix-icon":e.prefixIcon},{...e.options,...e.options["picker-options"]||e.options.pickerOptions,cellClassName:u=>e.isTodayOrDisabled(u),disabledDate:e.options["picker-options"]?.disabledDate||e.options.pickerOptions?.disabledDate||e.disabledDate,"popper-class":`cyw-base-font ${e.options["popper-class"]||e.options.popperClass||"cyw-datepicker__popper"}`,"default-time":e.getDefaultTime()},{onChange:e.change,onFocus:e.focus,onBlur:e.blur,onInputFocus:e.handleInputFocus,"onUpdate:modelValue":e.setDate,onVisibleChange:e.visibleChange}),{"range-separator":t.withCtx(()=>[t.createElementVNode("span",{class:t.normalizeClass(e.options["range-separator-class"]||"")},[t.renderSlot(e.$slots,"range-separator",{},()=>[t.createTextVNode(t.toDisplayString(e.options["range-separator"]||"-"),1)])],2)]),_:3},16,["modelValue","disabled","input-id","prefix-icon","onChange","onFocus","onBlur","onInputFocus","onUpdate:modelValue","onVisibleChange"])],6)],64)}const U=M._export_sfc(j,[["render",R]]);exports.default=U;
//# sourceMappingURL=CyDatePicker.cjs.map
