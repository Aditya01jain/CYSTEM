{"version":3,"file":"toaster.cjs","sources":["../../../src/components/toaster/toaster.ts"],"sourcesContent":["import Toaster from './Toaster.vue'\nimport { h, render } from 'vue'\nimport type { Toast, ToasterFn, ToasterProps } from './types'\nimport { uuId } from \"../../utilities/shared\";\nimport { OFFSET } from './variables';\n\nexport function toast({\n  placement = 'bottom-left',\n  type = 'linear',\n  duration = 5000,\n}: Toast): ToasterFn {\n  const gap: number = OFFSET.TOASTER_GAP\n  const toasterGroupId: string = uuId()\n\n  function createContainer(toasterId: string, type: string, placement: string) {\n    const container: HTMLElement = document.createElement('div')\n    container.classList.add(\n      'cyw-toaster',\n      'cyw-base-font',\n      'cyw-round-md',\n      type === 'card' ? `cyw-toaster--${placement}` : 'cyw-round-sm',\n      `cyw-toaster--${type}`,\n      'cyw-shadow-300'\n    )\n    container.setAttribute('cy-toaster_group_id', `toaster_group_${toasterGroupId}`)\n    container.setAttribute('id', `toaster_${toasterId}`)\n    return container;\n  }\n\n  function renderToast(toaster: any, container: HTMLElement): void {\n    render(toaster, container);\n    document.body.appendChild(container);\n  }\n\n  function calculateInitialHeight() {\n    const isLinear: boolean = type === 'linear'\n    const selector: string = isLinear ? '.cyw-toaster--linear' : `.cyw-toaster--${placement}`\n    let totalHeight:number =  isLinear ? OFFSET.LINEAR_INITIAL_OFFSET : OFFSET.CARD_INITIAL_OFFSET\n    const elements: NodeListOf<HTMLElement> = document.querySelectorAll(selector)\n    elements?.forEach((element: HTMLElement) => {\n      totalHeight += ( isLinear ? -1 : 1 ) * (element.offsetHeight + gap)\n    })\n    return `${totalHeight}px`\n  }\n\n  function rearrangeList(\n    { type, placement }: { type: string; placement: string },\n    elements: NodeListOf<HTMLElement>\n  ) {\n    if (type === 'linear') setLinearToast(elements)\n    if (type === 'card') setCardToast(elements, placement.split('-')[0])\n  }\n\n  function setCardToast(elements: NodeListOf<HTMLElement>, yValue: string) {\n    let totalHeight = OFFSET.CARD_INITIAL_OFFSET\n\n    elements.forEach((element: HTMLElement) => {\n      element.style[yValue] = totalHeight.toString() + 'px'\n      totalHeight += element.offsetHeight + gap\n      return element\n    })\n  }\n\n  function setLinearToast(elements: NodeListOf<HTMLElement>) {\n    let totalHeight = OFFSET.LINEAR_INITIAL_OFFSET\n    elements.forEach((element: HTMLElement) => {\n      element.style.top = totalHeight.toString() + 'px'\n      totalHeight -= element.offsetHeight + gap\n      return element\n    })\n  }\n\n  function handleAutoClose(container: HTMLElement, duration: number) {\n    setTimeout(() => {\n      container.classList.add('cyw-toaster--hidden')\n      setTimeout(() => {\n        container.remove()\n        const querySelector: string = type === 'linear' ? '.cyw-toaster--linear' : `.cyw-toaster--${placement}`\n        const elements: NodeListOf<HTMLElement> = document.querySelectorAll(querySelector)\n        if (elements.length) rearrangeList({ type, placement }, elements)\n      }, 300)\n    }, duration)\n  }\n\n  function close(toasterId: string) {\n    const el: HTMLElement | null = document.getElementById(`toaster_${toasterId}`)\n    if (el) {\n      el.classList.add('cyw-toaster--hidden')\n      setTimeout(() => {\n        el.remove()\n        const querySelector: string = type === 'linear' ? '.cyw-toaster--linear' : `.cyw-toaster--${placement}`\n        const elements: NodeListOf<HTMLElement> = document.querySelectorAll(querySelector)\n        if (elements.length) rearrangeList({ type, placement }, elements)\n      }, 300)\n    }\n  }\n\n  function closeAll() {\n    const elements: NodeListOf<HTMLElement> = document.querySelectorAll(`[cy-toaster_group_id=\"toaster_group_${toasterGroupId}\"]`)\n    elements.forEach((element: HTMLElement) => {\n      const toasterId: string = element.getAttribute('id')?.split('toaster_')?.[1] || ''\n      if(toasterId) close(toasterId)\n    })\n  }\n\n  function enableToast(props: ToasterProps) {\n    try {\n      let toasterId: string = uuId()\n      const toaster: any = h(Toaster, {\n        ...props,\n        type,\n        duration,\n        toasterId,\n        onClose: close\n      })\n    \n      const container: HTMLElement = createContainer(toasterId, type, placement)\n\n\n      if (type === 'linear') \n        container.style.top = calculateInitialHeight()\n      \n\n      if (type === 'card') {\n        const [yValue, xValue]: string[] = placement.split('-')\n        container.style[yValue] = calculateInitialHeight()\n        container.style[xValue] = OFFSET.CARD_INITIAL_OFFSET + 'px'\n      }\n\n      renderToast(toaster, container)\n      if (duration) handleAutoClose(container, duration)\n  \n      return toasterId;\n    } catch (error) {\n      //\n    }\n  }\n\n  return {\n    error: (props: ToasterProps) => enableToast({ ...props, status: 'error' }),\n    success: (props: ToasterProps) => enableToast({ ...props, status: 'success' }),\n    warning: (props: ToasterProps) => enableToast({ ...props, status: 'warning' }),\n    info: (props: ToasterProps) => enableToast({ ...props, status: 'info' }),\n    close: (toasterId: string) => close(toasterId),\n    closeAll\n  }\n}\n"],"names":["toast","placement","type","duration","gap","OFFSET","toasterGroupId","uuId","createContainer","toasterId","container","renderToast","toaster","render","calculateInitialHeight","isLinear","selector","totalHeight","element","rearrangeList","elements","setLinearToast","setCardToast","yValue","handleAutoClose","querySelector","close","el","closeAll","enableToast","props","h","Toaster","xValue"],"mappings":"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"}