{"version":3,"file":"codesnippet.cjs","sources":["../../../../src/components/input-editor/plugins/codesnippet.js"],"sourcesContent":["import FroalaEditor from \"froala-editor\";\n\nconst EMPTY_SELECTION_TEXT =\n  \"Select text to display the content in a code block.\";\n\nconst POPUP_STYLE =\n  \"font-size: 14px; padding: 20px; max-width: 200px; word-break: break-word\";\n\nFroalaEditor.POPUP_TEMPLATES[\"codeSnippet.popup\"] = \"[_CUSTOM_LAYER_]\";\n\nFroalaEditor.PLUGINS.codeSnippet = function (editor) {\n  const apply = () => {\n    const blocks = editor.selection.blocks();\n    const text = blocks\n      .map((block) => `<div>${block.innerHTML}</div>`)\n      .join(\"\");\n    editor.html.insert(`<pre class=\"before-hl\"><code>${text}</code></pre><br>`);\n\n    const codeBlock = editor.el;\n    codeBlock.querySelectorAll(\".before-hl code br\").forEach((element) => {\n      element.replaceWith(document.createTextNode(\"\\n\"));\n    });\n\n    codeBlock.querySelectorAll(\"pre.before-hl code div\").forEach((element) => {\n      // hljs.highlightElement(element);\n    });\n\n    codeBlock.querySelectorAll(\"pre.before-hl\").forEach((block) => {\n      block.classList.remove(\"before-hl\");\n    });\n  };\n  const initPopup = () => {\n    const template = {\n      custom_layer: `<div style=\"${POPUP_STYLE}\">${EMPTY_SELECTION_TEXT}</div>`\n    };\n    return editor.popups.create(\"codeSnippet.popup\", template);\n  };\n  const showPopup = () => {\n    let $popup = editor.popups.get(\"codeSnippet.popup\");\n    if (!$popup) initPopup();\n    editor.popups.setContainer(\"codeSnippet.popup\", editor.$tb);\n    editor.popups.refresh(\"codeSnippet.popup\");\n    const $btn = editor.$tb.find('.fr-command[data-cmd=\"codeSnippet\"]');\n    const left = $btn.offset().left - 10;\n    const top =\n      $btn.offset().top +\n      (editor.opts.toolbarBottom ? 10 : $btn.outerHeight() - 10);\n    editor.popups.show(\"codeSnippet.popup\", left, top, $btn.outerHeight());\n  };\n  return {\n    apply: apply,\n    showPopup: showPopup\n  };\n};\n\nFroalaEditor.DefineIconTemplate(\n  \"cyware-design\",\n  '<i class=\"cy-flex-center cy-text-f18 cyicon cyicon-code-snippet\"></i>'\n);\n\nFroalaEditor.DefineIcon(\"codeSnippetIcon\", {\n  NAME: \"codeSnippetIcon\",\n  template: \"cyware-design\"\n});\n\nFroalaEditor.RegisterCommand(\"codeSnippet\", {\n  title: \"Code Snippet\",\n  icon: \"codeSnippetIcon\",\n  undo: true,\n  focus: true,\n  refreshAfterCallback: true,\n  callback: function () {\n    const isSelected = !this.selection.isCollapsed();\n    isSelected ? this.codeSnippet.apply() : this.codeSnippet.showPopup();\n  }\n});\n"],"names":["EMPTY_SELECTION_TEXT","POPUP_STYLE","FroalaEditor","editor","apply","text","block","codeBlock","element","initPopup","template","$btn","left","top"],"mappings":"8CAEMA,EACJ,sDAEIC,EACJ,2EAEFC,EAAa,gBAAgB,mBAAmB,EAAI,mBAEpDA,EAAa,QAAQ,YAAc,SAAUC,EAAQ,CACnD,MAAMC,EAAQ,IAAM,CAElB,MAAMC,EADSF,EAAO,UAAU,OAAM,EAEnC,IAAKG,GAAU,QAAQA,EAAM,SAAS,QAAQ,EAC9C,KAAK,EAAE,EACVH,EAAO,KAAK,OAAO,gCAAgCE,CAAI,mBAAmB,EAE1E,MAAME,EAAYJ,EAAO,GACzBI,EAAU,iBAAiB,oBAAoB,EAAE,QAASC,GAAY,CACpEA,EAAQ,YAAY,SAAS,eAAe;AAAA,CAAI,CAAC,CACvD,CAAK,EAEDD,EAAU,iBAAiB,wBAAwB,EAAE,QAASC,GAAY,CAE9E,CAAK,EAEDD,EAAU,iBAAiB,eAAe,EAAE,QAASD,GAAU,CAC7DA,EAAM,UAAU,OAAO,WAAW,CACxC,CAAK,CACL,EACQG,EAAY,IAAM,CACtB,MAAMC,EAAW,CACf,aAAc,eAAeT,CAAW,KAAKD,CAAoB,QACvE,EACI,OAAOG,EAAO,OAAO,OAAO,oBAAqBO,CAAQ,CAC7D,EAaE,MAAO,CACL,MAAON,EACP,UAdgB,IAAM,CACTD,EAAO,OAAO,IAAI,mBAAmB,GACrCM,IACbN,EAAO,OAAO,aAAa,oBAAqBA,EAAO,GAAG,EAC1DA,EAAO,OAAO,QAAQ,mBAAmB,EACzC,MAAMQ,EAAOR,EAAO,IAAI,KAAK,qCAAqC,EAC5DS,EAAOD,EAAK,OAAM,EAAG,KAAO,GAC5BE,EACJF,EAAK,OAAM,EAAG,KACbR,EAAO,KAAK,cAAgB,GAAKQ,EAAK,YAAW,EAAK,IACzDR,EAAO,OAAO,KAAK,oBAAqBS,EAAMC,EAAKF,EAAK,YAAW,CAAE,CACzE,CAIA,CACA,EAEAT,EAAa,mBACX,gBACA,uEACF,EAEAA,EAAa,WAAW,kBAAmB,CACzC,KAAM,kBACN,SAAU,eACZ,CAAC,EAEDA,EAAa,gBAAgB,cAAe,CAC1C,MAAO,eACP,KAAM,kBACN,KAAM,GACN,MAAO,GACP,qBAAsB,GACtB,SAAU,UAAY,CACD,CAAC,KAAK,UAAU,YAAW,EACjC,KAAK,YAAY,MAAO,EAAG,KAAK,YAAY,WAC1D,CACH,CAAC"}