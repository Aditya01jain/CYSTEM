"use strict";const e=require("vue"),v=require("radash"),d=require("./CyButton.vue_vue_type_script_setup_true_lang-33e4d3d7.cjs"),w=require("./CyCheckbox.vue_vue_type_script_setup_true_lang-e85f0290.cjs"),b=require("./CySanitizeHtml.vue_vue_type_script_setup_true_lang-42e676e1.cjs"),E=require("./CySpinner.vue_vue_type_script_setup_true_lang-48349cab.cjs"),c=require("./components/eula/variable.cjs"),C={class:"cyw-color-base-font cyw-text-center cyw-m-0 cyw-my-4 cyw-text-f20 cyw-text-regular"},x={key:0,class:"cyw-flex-center cyw-w-100 cyw-h-100"},S={class:"cyw-eula__footer cyw-flex-align-center"},h={class:"cyw-flex-grow-1"},N=e.defineComponent({__name:"CyEula",props:{config:{type:Object,default:()=>{}},events:{type:Object,default:()=>{}},isDeclined:{type:Boolean,default:!1},apiConfig:{type:Object,default:()=>c.APIS}},emits:["accept","decline"],setup(u,{expose:_,emit:p}){const g=e.useAttrs(),a=u,r=p,i=e.ref(null),t=e.reactive({loading:{},strings:{},value:!1,licenseAgreement:"",disabled:!0});e.onMounted(()=>{y()}),e.onUnmounted(()=>{i?.value?.removeEventListener("scroll",()=>{})});const y=async()=>{t.loading.agreement=!0;const{agreement_html:n,...s}=await a.events?.get?.(a.apiConfig?.GET_AGREEMENT);t.licenseAgreement=n,t.strings={...a.config||c.DEFAULT_STRINGS,...s||{}},t.loading.agreement=!1,f()},f=()=>{const n=i?.value;n?.addEventListener("scroll",()=>{v.throttle({interval:c.THROTTLE_TIMER},()=>{t.disabled&&n.scrollHeight-n.scrollTop<=n.clientHeight+c.SCROLL_OFFSET&&(t.disabled=!1)})()})},o=async n=>{const{events:s={}}=a;if(s&&typeof s.post=="function"){t.loading.accept=!0;const l=await s.post(a.apiConfig?.ACCEPT_AGREEMENT,{is_license_self_signed:n}),m=l?.data||l;r("accept",m.is_license_self_signed),t.loading.accept=!1}};return e.watch(()=>a.isDeclined,n=>{o(!n)}),_({submit:o,value:t.value}),(n,s)=>(e.openBlock(),e.createElementBlock("div",e.mergeProps({class:"cyw-eula"},e.unref(g)||{}),[e.renderSlot(n.$slots,"header",{},()=>[e.createElementVNode("h1",C,e.toDisplayString(t.strings.heading),1)]),e.createElementVNode("div",{class:"cyw-eula__description cyw-border-1 cyw-round-lg cyw-py-2 cyw-px-4 cyw-mb-4 cyw-overflow-hidden cyw-overflow-y-auto cyw-bg-N50 cyw-h-100",ref_key:"agreementContainerRef",ref:i},[e.renderSlot(n.$slots,"body",{},()=>[t.loading.agreement?(e.openBlock(),e.createElementBlock("div",x,[e.createVNode(E._sfc_main,{size:3.2})])):(e.openBlock(),e.createBlock(b._sfc_main,{key:1,text:t.licenseAgreement},null,8,["text"]))])],512),e.createElementVNode("div",S,[e.renderSlot(n.$slots,"footer",{},()=>[e.createElementVNode("div",h,[e.createVNode(w._sfc_main,{modelValue:t.value,"onUpdate:modelValue":s[0]||(s[0]=l=>t.value=l),disabled:t.disabled,class:"cyw-w-fit"},{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(t.strings.acceptance_text),1)]),_:1},8,["modelValue","disabled"])]),e.renderSlot(n.$slots,"actions",e.normalizeProps(e.guardReactiveProps({...t.strings,loading:t.loading,submit:o,value:t.value})),()=>[e.createVNode(d._sfc_main,{type:"tertiary",class:"cyw-mr-2",disabled:t.loading.accept,onClick:s[1]||(s[1]=l=>r("decline"))},{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(t.strings.decline_btn_text),1)]),_:1},8,["disabled"]),e.createVNode(d._sfc_main,{type:"primary",loading:t.loading.accept,disabled:!t.value||t.loading.accept,onClick:s[2]||(s[2]=l=>o(!0))},{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(t.strings.accept_btn_text),1)]),_:1},8,["loading","disabled"])])])])],16))}});exports._sfc_main=N;
//# sourceMappingURL=CyEula.vue_vue_type_script_setup_true_lang-340d8651.cjs.map
