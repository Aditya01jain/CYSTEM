{"version":3,"file":"useScrollMixin.cjs","sources":["../../src/composables/useScrollMixin.js"],"sourcesContent":["import { computed, onBeforeUnmount, onMounted, reactive, useSlots, useAttrs } from \"vue\";\nimport ariaUtils from \"../utilities/aria-utils\";\nimport { uuId } from \"../utilities/shared\";\n\nexport function useScrollMixin(props, title) {\n  const states = reactive({\n    componentId: uuId(),\n    labelledBy: null,\n  });\n\n  const slots = useSlots();\n  const attrs = useAttrs();\n\n  const dynamicAttrs = computed(() => {\n    let attributes = { ...(attrs || {}) };\n    if (attributes?.[\"aria-labelledby\"]?.length) return attributes;\n    let label = title || attributes[\"aria-label\"];\n    if (!label?.length && states.labelledBy?.length) {\n      attributes[\"aria-labelledby\"] = states.labelledBy;\n    }\n    return attributes;\n  });\n\n  onMounted(() => {\n    initTitle();\n  });\n\n  onBeforeUnmount(() => {\n    removeScrollListener();\n  });\n\n  function initTitle() {\n    let nodeElement = null;\n    let element = slots?.[\"modal-title\"]?.[0]?.elm;\n    const selector = attrs[\"data-title-selector\"];\n    if (selector?.length) nodeElement = ariaUtils.findNode(selector);\n    if (element instanceof HTMLElement && !nodeElement) nodeElement = element;\n    if (nodeElement instanceof HTMLElement) {\n      const labelId = `title-${states.componentId}`;\n      nodeElement?.setAttribute(\"id\", labelId);\n      states.labelledBy = labelId;\n    }\n  }\n\n  function addScrollListener() {\n    const scrollY = window.scrollY;\n    const body = document.body;\n    body.style.position = \"fixed\";\n    body.style.width = \"100%\";\n    body.style.top = `-${scrollY}px`;\n  }\n\n  function removeScrollListener() {\n    const body = document.body;\n    const scrollY = body.style.top;\n    body.style.position = \"\";\n    body.style.top = \"\";\n    window.scrollTo(0, parseInt(scrollY || \"0\") * -1);\n  }\n\n  return { dynamicAttrs, addScrollListener, removeScrollListener, states };\n}\n"],"names":["useScrollMixin","props","title","states","reactive","uuId","slots","useSlots","attrs","useAttrs","dynamicAttrs","computed","attributes","onMounted","initTitle","onBeforeUnmount","removeScrollListener","nodeElement","element","selector","ariaUtils","labelId","addScrollListener","scrollY","body"],"mappings":"qLAIO,SAASA,EAAeC,EAAOC,EAAO,CAC3C,MAAMC,EAASC,EAAAA,SAAS,CACtB,YAAaC,EAAAA,KAAM,EACnB,WAAY,IAChB,CAAG,EAEKC,EAAQC,EAAAA,WACRC,EAAQC,EAAAA,WAERC,EAAeC,EAAAA,SAAS,IAAM,CAClC,IAAIC,EAAa,CAAE,GAAIJ,GAAS,CAAA,CAAG,EACnC,OAAII,IAAa,iBAAiB,GAAG,QAEjC,EADQV,GAASU,EAAW,YAAY,IAChC,QAAUT,EAAO,YAAY,SACvCS,EAAW,iBAAiB,EAAIT,EAAO,YAElCS,CACX,CAAG,EAEDC,EAAAA,UAAU,IAAM,CACdC,GACJ,CAAG,EAEDC,EAAAA,gBAAgB,IAAM,CACpBC,GACJ,CAAG,EAED,SAASF,GAAY,CACnB,IAAIG,EAAc,KACdC,EAAUZ,IAAQ,aAAa,IAAI,CAAC,GAAG,IAC3C,MAAMa,EAAWX,EAAM,qBAAqB,EAG5C,GAFIW,GAAU,SAAQF,EAAcG,EAAAA,QAAU,SAASD,CAAQ,GAC3DD,aAAmB,aAAe,CAACD,IAAaA,EAAcC,GAC9DD,aAAuB,YAAa,CACtC,MAAMI,EAAU,SAASlB,EAAO,WAAW,GAC3Cc,GAAa,aAAa,KAAMI,CAAO,EACvClB,EAAO,WAAakB,CACrB,CACF,CAED,SAASC,GAAoB,CAC3B,MAAMC,EAAU,OAAO,QACjBC,EAAO,SAAS,KACtBA,EAAK,MAAM,SAAW,QACtBA,EAAK,MAAM,MAAQ,OACnBA,EAAK,MAAM,IAAM,IAAID,CAAO,IAC7B,CAED,SAASP,GAAuB,CAC9B,MAAMQ,EAAO,SAAS,KAChBD,EAAUC,EAAK,MAAM,IAC3BA,EAAK,MAAM,SAAW,GACtBA,EAAK,MAAM,IAAM,GACjB,OAAO,SAAS,EAAG,SAASD,GAAW,GAAG,EAAI,EAAE,CACjD,CAED,MAAO,CAAE,aAAAb,EAAc,kBAAAY,EAAmB,qBAAAN,EAAsB,OAAAb,CAAM,CACxE"}