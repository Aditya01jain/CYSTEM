"use strict";Object.defineProperties(exports,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}});const e=require("../../utilities/aria-utils.cjs"),o=require("../../utilities/constants.cjs"),u=require("../../utilities/shared.cjs");class n{constructor({el:t}){this.el=t,this.initBindListeners(),this.targetBody=this.el?.getAttribute("cy-body-target")==="true",this.initFocus=this.el?.getAttribute("cy-focus-first")||null}initBindListeners(){this.initNodeFocus=this.initNodeFocus.bind(this)}init(t={}){this.resetNode(t);const s=this.initFocusFirstNode(t);if(!u.isNull(this.focusFirst)&&s){const i=e.default.findNode(this.focusFirst,this.el);u.isNull(i)&&(this.focusFirst=null),this.initListener(i)}}initFocusFirstNode(t){let s=this.value?.focusFirst||null;if(u.isNull(this.focusFirst)||!this.focusFirst)return this.focusFirst=this.initFocus||s,!0;let i=!1;return s?.length&&this.focusFirst!==s&&(this.focusFirst=s,i=!0),i}initListener(t){typeof t=="object"&&!u.isNull(t)&&this.addListener(t)}getAttributeNode(){let t=this.value?.focusFirst||null;const s=this.el?.getAttribute("cy-focus-first")||null;return{focusFirst:t,attribute:s}}resetNode(t={}){const{reInit:s=!1}=t;s&&(this.reset(),this.targetBody&&document?.body?.focus())}initNodeFocus(t,s){const i=t?.target,r=this.isBodyElement(i);return r&&this.isFirstFocused&&this.reset(),this.isFirstFocused?!0:t?.which===o.KEYBOARD_EVENTS.TAB&&(this.isInside(i)||r)?(e.default.preventEvents(t),e.default.attemptFocus(s)||e.default.focusFirstDescendant(s),this.isFirstFocused=!0,!1):!0}isInside(t){return this.el?.contains(t)||this.el===t}isBodyElement(t){return!this.targetBody||!t?!1:t===document?.body&&document?.body.contains(this.el)}addListener(t){document?.addEventListener("keydown",s=>this.initNodeFocus(s,t))}removeListener(){(this.isFirstFocused||!document.body.contains(this.el))&&(this.reset(),document?.removeEventListener("keydown",t=>this.initNodeFocus(t)))}reset(){this.isFirstFocused=!1,this.focusFirst=null}}exports.default=n;
//# sourceMappingURL=model.cjs.map
