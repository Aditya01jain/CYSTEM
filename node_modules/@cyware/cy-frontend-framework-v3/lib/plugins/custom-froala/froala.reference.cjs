"use strict";const a=require("froala-editor"),k="min-width: 13.5rem; width: 25rem; word-break: break-word; max-height: 20rem;";a.POPUP_TEMPLATES["reference.popup"]="[_CUSTOM_LAYER_]";a.PLUGINS.reference=function(e){let u;const s=e.$el?.[0]?.parentElement;function m(){s.addEventListener("click",l),s.addEventListener("keyup",l)}function v(){s.removeEventListener("click",l),s.removeEventListener("keyup",l)}m();function l(){const t=window.getSelection();t.rangeCount>0&&(u=t.getRangeAt(0))}const y=async()=>{const c=await e?.opts?.callback({type:"getReferenceList"})||[];let n=c.length,r=n&&c.map((p,o)=>{const i=o<n-1?"cyw-border-bottom-1":"";return`<div data-class="popup-option" data-value="${p.value}" class="cyw-p-2 cyw-m-2 cyw-cursor-pointer ${i}"> ${p.label} </div>`}).join("");const d='<button data-class="add-new-reference-btn" data-value="addNewReference" class="cyw-p-2 cyw-cursor-pointer cyw-color-P600 cyw-bg-N10"> + New Reference </button>';n?(r=r+'<hr class="cyw-color-N300"/>',r=r+d):r=d;const b={custom_layer:`
        <div style="${k}" class="cyw-text-f12 cyw-text-medium cyw-p-3 cyw-round-lg cyw-overflow-scroll cyw-bg-N10 cyw-color-N800">
        <div data-class="popup-options">
          ${r}
        </div>
      </div>
      `},w=e.popups.create("reference.popup",b);return(w.find('[data-class="popup-options"]')?.[0]).addEventListener("click",p=>{const o=p?.target?.getAttribute("data-value");if(o){const i=c.filter(f=>f.value===o)?.[0];if(i){let f=`<a data-id='reference-link' href='${i?.link}' target="_blank">[${o}]</a>`;e.html.insert(f)}e.opts.callback&&e.opts.callback({type:"select",selectedValue:o}),e.popups.hide("reference.popup")}}),w},g=(t={})=>{if(t?.value){let c=`<a data-id='reference-link' href='${t.link}' target="_blank">[${t.value}]</a>`;const n=window.getSelection();n.removeAllRanges(),n.addRange(u),e.html.insert(c),e.events.trigger("contentChanged")}},h=async()=>{await y(),e.popups.setContainer("reference.popup",e.$tb),e.popups.refresh("reference.popup");const t=e.$tb.find('.fr-command[data-cmd="reference"]'),c=t.offset().left-10,n=t.offset().top+(e.opts.toolbarBottom?10:t.outerHeight()-10);e.popups.show("reference.popup",c,n,t.outerHeight())};return e.events.on("destroy",function(){v()}),{showPopup:h,addLink:g}};a.DefineIconTemplate("cyware-reference",'<i class="cy-flex-center cy-text-f18 cyicon-file-pdf"></i>');a.DefineIcon("referenceIcon",{NAME:"referenceIcon",template:"cyware-reference"});a.RegisterCommand("reference",{title:"Reference",icon:"referenceIcon",undo:!0,focus:!0,refreshAfterCallback:!0,callback:function(){this.reference.showPopup()}});
//# sourceMappingURL=froala.reference.cjs.map
